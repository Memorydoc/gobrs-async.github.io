(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{315:function(t,s,a){"use strict";a.r(s);var n=a(6),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"完整配置示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#完整配置示例"}},[t._v("#")]),t._v(" 完整配置示例")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gobrs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("async")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("config")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rules")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 规则 是数组类型的 多组规则")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"general"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AService->BService->FService->GService->HService;EService->CService;AService"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("task-interrupt")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 局部异常是否打断主流程 默认false")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("transaction")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"anyConditionGeneral"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AServiceCondition,BServiceCondition,CServiceCondition->DServiceCondition"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("logConfig")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("costLogabled")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("false")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 开启任务耗时打印 log日志级别需要为 error 默认true")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("errLogabled")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 开启任务异常打印 默认true")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  AServiceCondition 、BServiceCondition、CServiceCondition任务谁返回true 谁有资格继续往下执行")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"anyConditionRule"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AServiceCondition,BServiceCondition,CServiceCondition->DServiceCondition:anyCondition"')]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"anyConditionRuleAppend"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AServiceCondition,BServiceCondition,CServiceCondition->DServiceCondition:anyCondition->EServiceCondition"')]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 官方场景一 https://async.sizegang.cn/pages/2f844b/#%E5%9C%BA%E6%99%AF%E4%B8%80")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"caseOne"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"caseOneTaskA->caseOneTaskB,caseOneTaskC,caseOneTaskD"')]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 官方场景二 https://async.sizegang.cn/pages/2f844b/#%E5%9C%BA%E6%99%AF%E4%BA%8C")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"caseTwo"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"caseTwoTaskA->caseTwoTaskB->caseTwoTaskC,caseTwoTaskD"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 官方场景三 https://async.sizegang.cn/pages/2f844b/#%E5%9C%BA%E6%99%AF%E4%B8%89")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"caseThree"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "caseThreeTaskA'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("caseThreeTaskB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("caseThreeTaskC"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("caseFourTaskD"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("caseThreeTaskG;\n                    caseThreeTaskA"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("caseThreeTaskE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("caseThreeTaskF"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v('caseThreeTaskG;"\n        '),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 官方场景四 https://async.sizegang.cn/pages/2f844b/#%E5%9C%BA%E6%99%AF%E5%9B%9B")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"caseFour"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "caseFourTaskA'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("caseFourTaskB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("caseFourTaskC"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("caseFourTaskD"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("caseFourTaskE;\n                    caseFourTaskA"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("caseFourTaskH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("caseFourTaskI"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("caseFourTaskJ"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v('caseFourTaskK;"\n          '),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("logConfig")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("costLogabled")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("false")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 关闭耗时任务打印")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 官方场景五 https://async.sizegang.cn/pages/2f844b/#%E5%9C%BA%E6%99%AF%E4%BA%94")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"caseFive"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"caseFourTaskA,caseFourTaskB,caseFourTaskC->caseFourTaskD:any:exclusive"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# any 任意一个任务（A、B、C）执行完成后 则执行D任务")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# exclusive 避免任务执行浪费 所以 D执行完成之后 会主动 中断 未完成的任务")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("server")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("port")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9999")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 端口: 8080")]),t._v("\n")])])]),s("h2",{attrs:{id:"配置文件位置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置文件位置"}},[t._v("#")]),t._v(" 配置文件位置")]),t._v(" "),s("p",[t._v("如果开发者配置较多 与 "),s("code",[t._v("springboot")]),t._v(" 配置文件放在一起有点冗余的话，可以在 "),s("code",[t._v("resources/config")]),t._v(" 目录下创建以下配置文件都是支持的。")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("gobrs.yaml")])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("gobrs.yml")])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("gobrs.properties")])])])]),t._v(" "),s("h2",{attrs:{id:"规则组成"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#规则组成"}},[t._v("#")]),t._v(" 规则组成")]),t._v(" "),s("h2",{attrs:{id:"规则名称-name"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#规则名称-name"}},[t._v("#")]),t._v(" 规则名称 name")]),t._v(" "),s("p",[t._v("规则对象又两部分组成：")]),t._v(" "),s("ul",[s("li",[t._v("规则名称")]),t._v(" "),s("li",[t._v("规则内容")])]),t._v(" "),s("p",[s("strong",[t._v("规则名称")]),t._v("(name) 约定规则的唯一标识符： 在任务触发器开发触发任务的时候需要传递。")]),t._v(" "),s("h2",{attrs:{id:"规则内容-content"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#规则内容-content"}},[t._v("#")]),t._v(" 规则内容 content")]),t._v(" "),s("p",[s("strong",[t._v("规则内容")]),t._v("(content) 则是规则引擎解析的核心内容，根据任务执行流程不同，任务规则配置也会不同，但是不会很复杂，详细配置流程分为一下几种场景。")]),t._v(" "),s("h2",{attrs:{id:"日志配置-logconfig"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#日志配置-logconfig"}},[t._v("#")]),t._v(" 日志配置 logConfig")]),t._v(" "),s("ul",[s("li",[t._v("costLogabled  流程日志打印 包括耗时时间，调用链路等")]),t._v(" "),s("li",[t._v("errLogabled  任务执行异常日志打印")])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("小提示")]),t._v(" "),s("p",[t._v("我们先说几种场景， 看完之后配置规则你自己就有感觉了")]),t._v(" "),s("p",[s("strong",[t._v("注:")]),t._v(" 下方配置中的 A、B、C 是指 动态任务在Spring中的Bean名称， 可以使用 "),s("code",[t._v('@Task("xxx")')]),t._v(" 定义\nruleName1 代表规则名称，")])]),t._v(" "),s("h2",{attrs:{id:"异常捕获"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#异常捕获"}},[t._v("#")]),t._v(" 异常捕获")]),t._v(" "),s("p",[t._v("在流程配置"),s("code",[t._v("task-interrupt")]),t._v("时，有些开发者不希望任务执行的异常被"),s("strong",[t._v("gobrs-async")]),t._v("包装。 而是想亲自进行异常捕获，根据异常类型进行不同业务处理。此时可以配置\n异常抛出配置: "),s("code",[t._v("catchable")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stopAsyncRule"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stopAsyncTaskA,stopAsyncTaskB,stopAsyncTaskC;stopAsyncTaskD->stopAsyncTaskE->stopAsyncTaskF"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("catchable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n")])])]),s("h2",{attrs:{id:"规则示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#规则示例"}},[t._v("#")]),t._v(" 规则示例")]),t._v(" "),s("h2",{attrs:{id:"场景一"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#场景一"}},[t._v("#")]),t._v(" 场景一")]),t._v(" "),s("p",[t._v("如图1-1")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://kevin-cloud-dubbo.oss-cn-beijing.aliyuncs.com/gobrs-async/type1.png",alt:"场景一"}})]),t._v(" "),s("p",[s("strong",[t._v("说明")]),t._v("\n任务A 执行完了之后，继续执行 B、C、D")]),t._v(" "),s("p",[s("strong",[t._v("配置")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gobrs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("async")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rules")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ruleName1"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A->B,C,D"')]),t._v("\n\n")])])]),s("h2",{attrs:{id:"场景二"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#场景二"}},[t._v("#")]),t._v(" 场景二")]),t._v(" "),s("p",[t._v("如图1-2")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://kevin-cloud-dubbo.oss-cn-beijing.aliyuncs.com/gobrs-async/type2.png",alt:"场景二"}})]),t._v(" "),s("p",[s("strong",[t._v("说明")]),t._v("\n任务A 执行完了之后执行B 然后再执行 C、D")]),t._v(" "),s("p",[s("strong",[t._v("配置")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gobrs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("async")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rules")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ruleName1"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A->B->C,D"')]),t._v("\n\n")])])]),s("h2",{attrs:{id:"场景三"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#场景三"}},[t._v("#")]),t._v(" 场景三")]),t._v(" "),s("p",[t._v("如图1-3")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://kevin-cloud-dubbo.oss-cn-beijing.aliyuncs.com/gobrs-async/type3.png",alt:"场景二"}})]),t._v(" "),s("p",[s("strong",[t._v("说明")]),t._v("\n任务A 执行完了之后执行B、E 然后按照顺序 B的流程走C、D、G。 E的流程走F、G")]),t._v(" "),s("p",[s("strong",[t._v("配置")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gobrs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("async")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rules")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ruleName1"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A->B->C->D->G;A->E->F->G"')]),t._v("\n\n")])])]),s("h2",{attrs:{id:"场景四"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#场景四"}},[t._v("#")]),t._v(" 场景四")]),t._v(" "),s("p",[t._v("如图1-4")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://kevin-cloud-dubbo.oss-cn-beijing.aliyuncs.com/gobrs-async/type5.png",alt:"场景二"}})]),t._v(" "),s("p",[s("strong",[t._v("说明")]),t._v("\n这种任务流程 Gobrs-Async 也能轻松支持")]),t._v(" "),s("p",[s("strong",[t._v("配置")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gobrs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("async")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rules")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ruleName1"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A->B->C,D,E;A->H->I,J,K"')]),t._v("\n\n")])])]),s("h2",{attrs:{id:"场景五"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#场景五"}},[t._v("#")]),t._v(" 场景五")]),t._v(" "),s("p",[t._v("如图1-5")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://kevin-cloud-dubbo.oss-cn-beijing.aliyuncs.com/gobrs-async/type6.png",alt:"场景二"}})]),t._v(" "),s("h3",{attrs:{id:"示例一"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例一"}},[t._v("#")]),t._v(" 示例一")]),t._v(" "),s("p",[s("strong",[t._v("说明")]),t._v("\nA、B、C 执行完之后再执行D")]),t._v(" "),s("p",[s("strong",[t._v("配置")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gobrs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("async")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rules")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ruleName1"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A,B,C->D"')]),t._v("\n\n")])])]),s("h3",{attrs:{id:"示例二"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例二"}},[t._v("#")]),t._v(" 示例二")]),t._v(" "),s("p",[s("strong",[t._v("说明")]),t._v("\nA、B、C 任务任意一个执行完成，则立即执行任务D（ 谁最快执行谁执行， 类似于任务流程竞争关系 ）\n此时可以使用 配置关键字 "),s("code",[t._v(":any")])]),t._v(" "),s("p",[s("strong",[t._v("配置")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gobrs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("async")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## :any 是关键字 表示任意 依赖的任务执行完成立即执行自己")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rules")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ruleName1"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A,B,C->D:any"')]),t._v("\n\n")])])]),s("h3",{attrs:{id:"示例三"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例三"}},[t._v("#")]),t._v(" 示例三")]),t._v(" "),s("p",[s("strong",[t._v("说明")]),t._v("\nA、B、C 任务任意一个执行完成，则立即执行任务D（ 谁最快执行谁执行， 类似于任务流程竞争关系 ）\n与示例不同的是， 如果 D拿到执行权后，会将自身所依赖的未完成的任务 强制中断执行（避免浪费资源，业务运行等）\n此时可以使用 配置关键字 "),s("code",[t._v(":exclusive")])]),t._v(" "),s("p",[s("strong",[t._v("配置")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gobrs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("async")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## :exclusive 是关键字")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rules")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ruleName1"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A,B,C->D:any:exclusive"')]),t._v("\n\n")])])]),s("h3",{attrs:{id:"示例四"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例四"}},[t._v("#")]),t._v(" 示例四")]),t._v(" "),s("p",[t._v("同示例二有点类似，在示例二的场景下，无法根据某一个任务的执行成功或者失败进行后续任务的处理，示例二完全根据线程调度执行的随机顺序进行执行，即谁先执行完\n谁有资格继续往下执行，所以如果想 执行结果的条件 即： "),s("code",[t._v("task")]),t._v(" 方法返回 "),s("code",[t._v("true")]),t._v(" 则立即执行，返回false则不执行的判断条件进行控制。那么就有以下的实现方式。")]),t._v(" "),s("h3",{attrs:{id:"第一步-任务编写"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第一步-任务编写"}},[t._v("#")]),t._v(" 第一步 任务编写")]),t._v(" "),s("p",[t._v("（如果不清楚如何开发一个动态任务，请阅读下一章节："),s("strong",[t._v("动态任务")]),t._v("）")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Boolean")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("task")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),t._v(" o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TaskSupport")]),t._v(" support"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AServiceCondition Begin"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("300")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                i1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" i1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AServiceCondition Finish"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InterruptedException")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n           "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// log 打印")]),t._v("\n           "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//e.printStackTrace();")]),t._v("\n           "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 返回false 则没有资格执行子任务的逻辑")]),t._v("\n           "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n         \n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 返回true 进行执行子任务的逻辑")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"第二步-任务配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第二步-任务配置"}},[t._v("#")]),t._v(" 第二步 任务配置")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gobrs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("async")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## :any 是关键字 表示任意 依赖的任务执行完成立即执行自己")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rules")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ruleName1"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A,B,C->D:anyCondition"')]),t._v("\n")])])]),s("h3",{attrs:{id:"注意"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注意"}},[t._v("#")]),t._v(" 注意")]),t._v(" "),s("p",[t._v("示例三 需要和 示例二配合生效， 因为这两种示例是结合的一种场景。")]),t._v(" "),s("h2",{attrs:{id:"规则总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#规则总结"}},[t._v("#")]),t._v(" 规则总结")]),t._v(" "),s("p",[t._v("规则配置跟流程图几乎非常相近。")]),t._v(" "),s("ul",[s("li",[t._v("在任务分叉时 使用 "),s("code",[t._v(",")]),t._v(" 区分不同任务。")]),t._v(" "),s("li",[t._v("在任务流程发起时 用"),s("code",[t._v("->")]),t._v(" 区分任务流。")]),t._v(" "),s("li",[t._v("每个任务流结束后 用"),s("code",[t._v(";")]),t._v(" 进行结束配置。")])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),s("p",[t._v("如果你不习惯使用以上配置符号，想自定义在配置符号， 在 "),s("code",[s("strong",[t._v("Gobrs-Async")])]),t._v(" 中也是支持配置的，可以根据用户使用喜欢进行灵活配置\n只需要 在"),s("code",[t._v("application.yml")]),t._v(" 中配置即可")])])])}),[],!1,null,null,null);s.default=e.exports}}]);