(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{318:function(t,s,a){"use strict";a.r(s);var n=a(6),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"超时任务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#超时任务"}},[t._v("#")]),t._v(" 超时任务")]),t._v(" "),s("p",[s("strong",[t._v("何为超时任务？")]),t._v(" 顾名思义其实就是单一任务可以通过设置超时时间决定改任务是否继续执行。配置方式很简单。如下操作：")]),t._v(" "),s("p",[s("strong",[t._v("注解配置")]),t._v("\n使用 "),s("code",[t._v("@Task")]),t._v("注解中的 "),s("code",[t._v("timeoutInMilliseconds")]),t._v(" 属性进行配置。")]),t._v(" "),s("ul",[s("li",[t._v("timeoutInMilliseconds 固定使用毫秒数")])]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gobrs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("async"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("test"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("task"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("timeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token import"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gobrs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("async"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("core"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TaskSupport")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token import"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gobrs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("async"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("core"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("anno"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Task")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token import"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gobrs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("async"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("core"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("task"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AsyncTask")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token import"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("lombok"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SneakyThrows")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token import"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("lombok"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("extern"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("slf4j"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Slf4j")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * The type A service.\n * @program: gobrs -async-starter\n * @description:\n * @author: sizegang\n */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Slf4j")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Task")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("timeoutInMilliseconds "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("300")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CaseTimeoutTaskA")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AsyncTask")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * The .\n     */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("prepare")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),t._v(" o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('" 使用线程---"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@SneakyThrows")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("task")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),t._v(" o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TaskSupport")]),t._v(" support"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"CaseTimeoutTaskA Begin"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("400")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            i1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" i1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"CaseTimeoutTaskA Finish"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"result"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("necessary")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),t._v(" o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TaskSupport")]),t._v(" support"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("onSuccess")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TaskSupport")]),t._v(" support"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),s("h2",{attrs:{id:"超时监听线程池配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#超时监听线程池配置"}},[t._v("#")]),t._v(" 超时监听线程池配置")]),t._v(" "),s("p",[s("strong",[t._v("所谓的监听线程池配置即：监听任务超时的线程池的核心线程数，关于为什么要配置该参数。请查看下方的"),s("a",{attrs:{href:"#%E7%89%B9%E5%88%AB%E8%AF%B4%E6%98%8E"}},[t._v("原理分析")]),t._v("。")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gobrs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("async")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("config")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rules")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"chain1"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"taskA->taskB->taskC"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("timeout-core-size")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 核心线程数量")]),t._v("\n")])])]),s("p",[s("strong",[t._v("如果不配置则取默认值，默认值计算方式如下：")])]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("calculateCoreNum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" cpuCoreNum "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Runtime")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRuntime")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("availableProcessors")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BigDecimal")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cpuCoreNum"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("divide")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BigDecimal")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0.2"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("intValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"单例测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#单例测试"}},[t._v("#")]),t._v(" 单例测试")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://gitee.com/dromara/gobrs-async/blob/master/gobrs-async-test/src/test/java/com/gobrs/async/test/timeout/CaseTimeout.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("运行代码"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"运行结果"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#运行结果"}},[t._v("#")]),t._v(" 运行结果")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-12-09 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":51:41.031  INFO "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("37083")]),t._v(" --- "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("pool-2-thread-1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" c.g.a.t.task.timeout.CaseTimeoutTaskA    "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" caseTimeoutTaskA 使用线程---pool-2-thread-1\nCaseTimeoutTaskA Begin\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-12-09 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":51:41.355 ERROR "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("37083")]),t._v(" --- "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("   GobrsTimer-1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" com.gobrs.async.core.timer.GobrsTimer    "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" \n\ncom.gobrs.async.core.common.exception.TimeoutException: task caseTimeoutTaskA TimeoutException\n\tat com.gobrs.async.core.TaskLoader"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),t._v(".tick"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TaskLoader.java:394"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("classes/:na"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\tat com.gobrs.async.core.timer.GobrsTimer.lambda"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$addTimerListener")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GobrsTimer.java:80"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("classes/:na"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\tat java.util.concurrent.Executors"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$RunnableAdapter")]),t._v(".call"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Executors.java:511"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("na:1.8.0_251"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\tat java.util.concurrent.FutureTask.runAndReset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("FutureTask.java:308"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("na:1.8.0_251"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\tat java.util.concurrent.ScheduledThreadPoolExecutor"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ScheduledFutureTask")]),t._v(".access"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$301")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ScheduledThreadPoolExecutor.java:180"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("na:1.8.0_251"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\tat java.util.concurrent.ScheduledThreadPoolExecutor"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ScheduledFutureTask")]),t._v(".run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ScheduledThreadPoolExecutor.java:294"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("na:1.8.0_251"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ThreadPoolExecutor.java:1149"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("na:1.8.0_251"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\tat java.util.concurrent.ThreadPoolExecutor"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$Worker")]),t._v(".run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ThreadPoolExecutor.java:624"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("na:1.8.0_251"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\tat java.lang.Thread.run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Thread.java:748"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("na:1.8.0_251"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-12-09 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":51:41.375  INFO "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("37083")]),t._v(" --- "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("pool-2-thread-2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" c.g.a.t.task.timeout.CaseTimeoutTaskB    "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" caseTimeoutTaskB 使用线程---pool-2-thread-2\nCaseTimeoutTaskB Begin\nCaseTimeoutTaskB Finish\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-12-09 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":51:41.377  INFO "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("37083")]),t._v(" --- "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("pool-2-thread-2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" c.g.a.t.task.timeout.CaseTimeoutTaskC    "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" caseTimeoutTaskC 使用线程---pool-2-thread-2\nCaseTimeoutTaskC Begin\nCaseTimeoutTaskC Finish\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-12-09 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":51:43.426  INFO "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("37083")]),t._v(" --- "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("           main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" com.gobrs.async.core.TaskLoader          "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" 【ProcessTrace】Total cost: 2413ms【task】caseTimeoutTaskA cost :312ms【state】：fail【errMsg】: "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),t._v(" interrupted"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" -"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("【task】caseTimeoutTaskB cost :0ms【state】：success"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" -"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("【task】caseTimeoutTaskC cost :2011ms【state】：success"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\n")])])]),s("h2",{attrs:{id:"特别说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#特别说明"}},[t._v("#")]),t._v(" 特别说明")]),t._v(" "),s("ul",[s("li",[t._v("超时任务不支持线程复用，因为需要通过控制线程超时来进行逻辑判断，如果支持线程复用，可能会出现中断正在复用线程的任务执行。")]),t._v(" "),s("li",[t._v("熔断降级原理借鉴"),s("code",[t._v("Hystrix")]),t._v(" 方式处理，如果对"),s("code",[t._v("Hystrix")]),t._v("不熟悉可以借鉴 "),s("a",{attrs:{href:"https://my.oschina.net/13426421702/blog/3071368",target:"_blank",rel:"noopener noreferrer"}},[t._v("Hystrix 熔断降级原理解析"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("因线程调度的原因，超时时间可能存在10ms内的误差，可忽略！")])])])}),[],!1,null,null,null);s.default=e.exports}}]);