(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{329:function(s,t,a){"use strict";a.r(t);var n=a(6),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h3",{attrs:{id:"任务配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#任务配置"}},[s._v("#")]),s._v(" 任务配置")]),s._v(" "),t("div",{staticClass:"language-yaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"optionalRule"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("content")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"caseOptionalTaskA->caseOptionalTaskB->caseOptionalTaskC,caseOptionalTaskD->caseOptionalTaskE->caseOptionalTaskF"')]),s._v("\n")])])]),t("p",[s._v("如果开发者在调用时只希望执行 "),t("code",[s._v("caseOptionalTaskD")]),s._v(" , 则在任务链中 只需要执行"),t("code",[s._v("caseOptionalTaskA、caseOptionalTaskB、caseOptionalTaskD")]),s._v(" 三个任务即可即可。 其他任务不需要执行\n，提供了随机选择流程中任务执行的能力。")]),s._v(" "),t("h3",{attrs:{id:"调用方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#调用方式"}},[s._v("#")]),s._v(" 调用方式")]),s._v(" "),t("p",[t("code",[s._v("gobrsAsync.go")]),s._v("方法的第三个参数 "),t("code",[s._v("Set<String>")]),s._v(" 需要传递 要执行的任务 "),t("code",[s._v("bean")]),s._v(" 名称。")]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testOptional")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Map")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" params "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HashMap")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Set")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" options "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HashSet")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        options"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"caseOptionalTaskD"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" # options中添加要执行的任务 bean 名称\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AsyncResult")]),s._v(" asyncResult "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" gobrsAsync"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("go")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"optionalRule"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v(" params"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" options"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("300000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("h3",{attrs:{id:"测试用例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#测试用例"}},[s._v("#")]),s._v(" 测试用例")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://gitee.com/dromara/gobrs-async/blob/master/gobrs-async-test/src/test/java/com/gobrs/async/test/optional/CaseOptional.java",target:"_blank",rel:"noopener noreferrer"}},[s._v("源码地址"),t("OutboundLink")],1)]),s._v(" "),t("h3",{attrs:{id:"运行结果"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运行结果"}},[s._v("#")]),s._v(" 运行结果")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("CaseOptionalTaskA 任务执行\nCaseOptionalTaskA 任务执行完成\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-12-11 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(":47:32.511  INFO "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13458")]),s._v(" --- "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("o-8888-exec-152"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" com.gobrs.async.core.task.AsyncTask      "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1178133151138803")]),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1178133151138803")]),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("caseOptionalTaskA"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" execution\nCaseOptionalTaskB 任务执行\nCaseOptionalTaskB 任务执行完成\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-12-11 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(":47:32.613  INFO "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13458")]),s._v(" --- "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("o-8888-exec-152"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" com.gobrs.async.core.task.AsyncTask      "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1178133151138803")]),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1178133151138803")]),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("caseOptionalTaskB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" execution\nCaseOptionalTaskD 任务执行\nCaseOptionalTaskD任务执行完成\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-12-11 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(":47:32.718  INFO "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13458")]),s._v(" --- "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("o-8888-exec-152"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" com.gobrs.async.core.task.AsyncTask      "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1178133151138803")]),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1178133151138803")]),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("caseOptionalTaskD"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" execution\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-12-11 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(":47:32.718  INFO "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13458")]),s._v(" --- "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("o-8888-exec-152"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" com.gobrs.async.core.TaskLoader          "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1178133151138803")]),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),s._v(" 【ProcessTrace】Total cost: 311ms "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" traceId "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11781331511388032")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 【task】caseOptionalTaskA cost :102ms【state】：success"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("【task】caseOptionalTaskB cost :102ms【state】：success"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("【task】caseOptionalTaskD cost :105ms【state】：success"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \ncost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("311")]),s._v("\n")])])]),t("h4",{attrs:{id:"适应场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#适应场景"}},[s._v("#")]),s._v(" 适应场景")]),s._v(" "),t("p",[s._v("在做 "),t("strong",[s._v("ISV")]),s._v("  ("),t("a",{attrs:{href:"https://developer.51cto.com/article/712050.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("京东商城ISV组件化建设"),t("OutboundLink")],1),s._v(")  建设时， 楼层中的多个组件可能存在着任务流程的编排， 所需要的上游数据数量多少不一，所以此时就需要进行编排流程中的任务选择执行处理了。\n如下对每个组件进行编排数据编排处理。\n"),t("img",{attrs:{src:"https://kevin-cloud-dubbo.oss-cn-beijing.aliyuncs.com/gobrs-async/image-20220809222627074.png",alt:"image-20220809222627074"}})])])}),[],!1,null,null,null);t.default=e.exports}}]);