(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{316:function(t,a,s){"use strict";s.r(a);var n=s(6),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"重试任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重试任务"}},[t._v("#")]),t._v(" 重试任务")]),t._v(" "),a("p",[t._v("执行中的任务会出现异常的情况，如果使用者有对任务失败重试的需求，"),a("strong",[t._v("Gobrs-Async")]),t._v(" 也为你提供了支持,只需要在 需要开启重试的任务 "),a("code",[t._v("bean")]),t._v("\n中使用 "),a("code",[t._v("@Task(retryCount = 10)")]),t._v(" 注解，框架则自动会为你开启重试模式。 "),a("code",[t._v("retryCount")]),t._v(" 所跟的数字为 "),a("strong",[t._v("重试次数")])]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Component")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Task")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("retryCount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BService")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AsyncTask")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"单测用例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#单测用例"}},[t._v("#")]),t._v(" 单测用例")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://gitee.com/dromara/gobrs-async/blob/master/gobrs-async-test/src/test/java/com/gobrs/async/test/retry/CaseTimeout.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("单测地址"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"运行结果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行结果"}},[t._v("#")]),t._v(" 运行结果")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-12-09 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":36:35.444  INFO "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("99720")]),t._v(" --- "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("pool-2-thread-1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" c.g.a.test.task.retry.CaseRetryTaskA     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" caseRetryTaskA 使用线程---pool-2-thread-1\nCaseRetryTaskA Begin\nCaseRetryTaskA End\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-12-09 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":36:35.458  INFO "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("99720")]),t._v(" --- "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("pool-2-thread-1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" c.g.a.test.task.retry.CaseRetryTaskC     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" caseRetryTaskC 使用线程---pool-2-thread-1\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-12-09 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":36:35.458  INFO "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("99720")]),t._v(" --- "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("pool-2-thread-2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" c.g.a.test.task.retry.CaseRetryTaskB     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" caseRetryTaskB 使用线程---pool-2-thread-2\nCaseRetryTaskC Begin\nCaseRetryTaskB Begin\nCaseRetryTaskC Finish\nCaseRetryTaskB Begin\nCaseRetryTaskB Begin\nCaseRetryTaskB Begin\nCaseRetryTaskB Begin\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-12-09 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":36:35.475 ERROR "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("99720")]),t._v(" --- "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("pool-2-thread-2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" com.gobrs.async.core.task.AsyncTask      "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("traceId:11770907551682560"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" caseRetryTaskB 任务执行失败\n\njava.lang.ArithmeticException: / by zero\n\tat com.gobrs.async.test.task.retry.CaseRetryTaskB.task"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CaseRetryTaskB.java:27"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("classes/:na"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\tat com.gobrs.async.core.task.AsyncTask.taskAdapter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("AsyncTask.java:124"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("classes/:na"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\tat com.gobrs.async.core.TaskActuator.call"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TaskActuator.java:145"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("classes/:na"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\tat com.alibaba.ttl.TtlCallable.call"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TtlCallable.java:58"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("transmittable-thread-local-2.11.2.jar:na"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\tat java.util.concurrent.FutureTask.run"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$$")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$capture")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("FutureTask.java:266"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("na:1.8.0_251"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\tat java.util.concurrent.FutureTask.run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("FutureTask.java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("na:1.8.0_251"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ThreadPoolExecutor.java:1149"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("na:1.8.0_251"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\tat java.util.concurrent.ThreadPoolExecutor"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$Worker")]),t._v(".run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ThreadPoolExecutor.java:624"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("na:1.8.0_251"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\tat java.lang.Thread.run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Thread.java:748"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("na:1.8.0_251"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-12-09 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":36:35.476 ERROR "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("99720")]),t._v(" --- "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("pool-2-thread-2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" c.g.a.test.inteceptor.GobrsInterceptor   "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" Execute global interceptor  error\n")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);