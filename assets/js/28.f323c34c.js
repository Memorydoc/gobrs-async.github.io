(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{337:function(t,a,s){"use strict";s.r(a);var n=s(6),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("市面主流并发编程框架有如下几款产品：")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Gobrs-Async")])]),t._v(" "),a("li",[a("strong",[a("a",{attrs:{href:"https://liteflow.yomahub.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("LiteFlow"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("strong",[a("a",{attrs:{href:"https://gitee.com/jd-platform-opensource/asyncTool?_from=gitee_search",target:"_blank",rel:"noopener noreferrer"}},[t._v("asyncTool"),a("OutboundLink")],1)])])]),t._v(" "),a("h2",{attrs:{id:"使用工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用工具"}},[t._v("#")]),t._v(" 使用工具")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://blog.csdn.net/qq_45138120/article/details/124056704",target:"_blank",rel:"noopener noreferrer"}},[t._v("jmeter"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://hippo4j.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("hippo4j.cn"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"测试阶段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试阶段"}},[t._v("#")]),t._v(" 测试阶段")]),t._v(" "),a("p",[t._v("1、使用动态线程池框架设置 核心线程数：100 最大线程数 100\n2、jmeter线程数 120 线程\n3、jmeter 运行时长 33s\n4、测试机器： mac m1 16G")]),t._v(" "),a("h3",{attrs:{id:"线程池配置如下"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#线程池配置如下"}},[t._v("#")]),t._v(" 线程池配置如下")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://kevin-cloud-dubbo.oss-cn-beijing.aliyuncs.com/gobrs-async/4101670741646_.pic.jpg",alt:"配置一"}})]),t._v(" "),a("h2",{attrs:{id:"测试结果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试结果"}},[t._v("#")]),t._v(" 测试结果")]),t._v(" "),a("h3",{attrs:{id:"gobrs-async"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gobrs-async"}},[t._v("#")]),t._v(" gobrs-async")]),t._v(" "),a("p",[a("strong",[t._v("jmeter测试结果")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://kevin-cloud-dubbo.oss-cn-beijing.aliyuncs.com/gobrs-async/4111670741739_.pic.jpg",alt:"gobrs-async-1"}})]),t._v(" "),a("p",[a("strong",[t._v("线程池运行状态")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://kevin-cloud-dubbo.oss-cn-beijing.aliyuncs.com/gobrs-async/4121670741807_.pic.jpg",alt:"gobrs-async-1-dy"}})]),t._v(" "),a("p",[t._v("可以看到 gobrs-async 在120个压测线程，核心线程数和最大线程数在100的情况下， 线程池负载和核心线程数、最大线程数并没有到达瓶颈，活跃线程数维持在70-80\n之间。降低了线程切换带来的开销同时节省了线程数的开销。")]),t._v(" "),a("h3",{attrs:{id:"liteflow"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#liteflow"}},[t._v("#")]),t._v(" liteflow")]),t._v(" "),a("p",[a("strong",[t._v("jmeter测试结果")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://kevin-cloud-dubbo.oss-cn-beijing.aliyuncs.com/gobrs-async/4131670742046_.pic.jpg",alt:"liteflow-1"}})]),t._v(" "),a("p",[a("strong",[t._v("线程池运行状态")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://kevin-cloud-dubbo.oss-cn-beijing.aliyuncs.com/gobrs-async/4141670742126_.pic_hd.jpg",alt:"liteflow-1-dy"}})]),t._v(" "),a("p",[t._v("可以看到liteflow线程池的最大线程数量和线程池负载已经触发了最大线程数 100 的限制。")]),t._v(" "),a("p",[t._v("看一下线程使用情况")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("主线程使用http-nio-9999-exec-4\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-12-11 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(":11:54.936  INFO "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12074")]),t._v(" --- "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("nio-9999-exec-4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" com.yomahub.liteflow.core.FlowExecutor   "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" slot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" offered\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-12-11 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(":11:54.941  INFO "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12074")]),t._v(" --- "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("nio-9999-exec-4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" com.yomahub.liteflow.core.FlowExecutor   "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" requestId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("7a921ca5265f433a9268a6c14c466ee5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" has generated\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-12-11 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(":11:54.942  INFO "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12074")]),t._v(" --- "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("nio-9999-exec-4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" com.yomahub.liteflow.flow.element.Node   "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("7a921ca5265f433a9268a6c14c466ee5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("O"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("start component"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" execution\n使用http-nio-9999-exec-4\na\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-12-11 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(":11:55.090  INFO "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12074")]),t._v(" --- "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("lowThreadPool_0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" com.yomahub.liteflow.flow.element.Node   "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("7a921ca5265f433a9268a6c14c466ee5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("O"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("start component"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" execution\n使用liteflowThreadPool_0\nb\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-12-11 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(":11:55.092  INFO "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12074")]),t._v(" --- "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("lowThreadPool_1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" com.yomahub.liteflow.flow.element.Node   "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("7a921ca5265f433a9268a6c14c466ee5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("O"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("start component"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" execution\n使用liteflowThreadPool_1\nc\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-12-11 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(":11:55.198  INFO "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12074")]),t._v(" --- "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("nio-9999-exec-4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" com.yomahub.liteflow.flow.element.Node   "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("7a921ca5265f433a9268a6c14c466ee5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("O"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("start component"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" execution\n使用http-nio-9999-exec-4\nd\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-12-11 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(":11:55.303  INFO "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12074")]),t._v(" --- "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("lowThreadPool_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" com.yomahub.liteflow.flow.element.Node   "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("7a921ca5265f433a9268a6c14c466ee5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("O"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("start component"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" execution\n使用liteflowThreadPool_2\ne\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-12-11 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(":11:55.303  INFO "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12074")]),t._v(" --- "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("lowThreadPool_3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" com.yomahub.liteflow.flow.element.Node   "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("7a921ca5265f433a9268a6c14c466ee5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("O"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("start component"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" execution\n使用liteflowThreadPool_3\nf\n")])])]),a("p",[t._v("完成 "),a("code",[t._v("taskA->taskB,TaskC->taskD->taskE,taskF")]),t._v(" 任务流程的执行需要使用 5个线程（包含主线程）。")]),t._v(" "),a("h3",{attrs:{id:"asynctool"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#asynctool"}},[t._v("#")]),t._v(" asyncTool")]),t._v(" "),a("p",[t._v("因线程池框架与asyncTool 貌似没法完全兼容、调控核心和最大线程池参数对asyncTool不起作用，故不做测试。\n不过通过asyncTool 的执行日志可以看出，同样也是一个任务一个线程开启执行。日志如下：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("主线程使用http-nio-9999-exec-1\n使用pool-13-thread-1\nAsyncToolTaskA\n使用pool-13-thread-2\nAsyncToolTaskB\n使用pool-13-thread-3\nAsyncToolTaskC\n使用pool-13-thread-2\nAsyncToolTaskD\n使用pool-13-thread-4\nAsyncToolTaskE\n使用pool-13-thread-5\nAsyncToolTaskF\n耗时459\n")])])]),a("p",[t._v("完成 "),a("code",[t._v("taskA->taskB,TaskC->taskD->taskE,taskF")]),t._v(" 任务流程的执行需要使用 6个线程（包含主线程）。")]),t._v(" "),a("h2",{attrs:{id:"结论"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#结论"}},[t._v("#")]),t._v(" 结论")]),t._v(" "),a("blockquote",[a("p",[t._v("对比结论自行分析，这里就不做过多解释了哈。")])]),t._v(" "),a("p",[a("strong",[t._v("其他测试阶段就不再继续测试，感兴趣的小伙伴可以自行下载"),a("a",{attrs:{href:"https://gitee.com/Memorydoc/performance-compare",target:"_blank",rel:"noopener noreferrer"}},[t._v("测试demo"),a("OutboundLink")],1),t._v("进行测试。")])])])}),[],!1,null,null,null);a.default=e.exports}}]);